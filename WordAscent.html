<!DOCTYPE html>
<html>
<head>
  <title>Word Ascent - ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Å‡∏±‡∏ö‡∏Ñ‡∏£‡∏π‡∏£‡∏∏‡∏ï‡∏ï‡πå</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 30px; }
    button { font-size: 22px; padding: 10px 20px; margin: 10px; cursor: pointer; }
    input[type="text"] { font-size: 22px; padding: 6px; width: 200px; margin-top: 10px; }
    #feedback, #scoreDisplay, #timerDisplay { font-size: 20px; font-weight: bold; margin-top: 10px; }
    #gameSection { margin-top: 30px; display: none; }
    .correct { color: green; }
    .incorrect { color: red; }
    /* Style for player name input */
    #playerNameInput { margin-bottom: 20px; }
    #playerNameInput input { margin-left: 10px; }
    
    /* Styles for the results table */
    #resultsSection { margin-top: 40px; display: none; } /* Initially hidden */
    #resultsTableContainer { 
        width: 95%; /* Adjust width as needed */
        max-width: 1200px; /* Max width for large screens */
        margin: 20px auto; 
        overflow-x: auto; /* Enable horizontal scrolling for narrow screens */
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #resultsTable {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px; /* Smaller font for table to fit more columns */
        min-width: 900px; /* Ensure table doesn't shrink too much */
    }
    #resultsTable th, #resultsTable td {
        border: 1px solid #ddd;
        padding: 8px 4px; /* Adjust padding to make columns narrower */
        text-align: center;
        white-space: nowrap; /* Prevent text wrapping in headers */
    }
    #resultsTable th {
        background-color: #f2f2f2;
        font-weight: bold;
        padding: 8px 2px;
        vertical-align: bottom; /* Align text at the bottom for rotated text */
        height: 100px; /* Increased height for vertical text */
    }
    #resultsTable thead th:first-child {
        height: auto; /* Reset height for the "‡∏ä‡∏∑‡πà‡∏≠" column */
        vertical-align: middle;
    }
    #resultsTable tbody tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    #resultsTable tbody td {
        font-weight: normal;
    }
    #resultsTable .correct-mark { color: green; font-weight: bold; }
    #resultsTable .incorrect-mark { color: red; font-weight: bold; }

    /* For vertical text in table headers */
    .vertical-text {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        transform: rotate(180deg); /* Rotate 180 degrees to read bottom-up */
        white-space: nowrap;
        text-align: left;
        padding: 0 5px;
    }

    /* Style for result classification */
    .excellent { color: #2196f3; font-weight: bold; } /* ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° */
    .good { color: #4caf50; font-weight: bold; }    /* ‡∏î‡∏µ */
    .medium { color: #ffeb3b; font-weight: bold; }    /* ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á */
    .fair { color: #ff9800; font-weight: bold; }      /* ‡∏û‡∏≠‡πÉ‡∏ä‡πâ */
    .poor { color: #f44336; font-weight: bold; }      /* ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á */

    /* Custom styles for spacing adjustment */
    .intro-text {
        margin-bottom: 5px; /* ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ */
    }
    .game-instruction {
        margin-top: 5px; /* ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏° */
    }
    /* ‡∏õ‡∏£‡∏±‡∏ö margin ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á */
    #startBtn {
        margin-top: 10px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
        margin-bottom: 20px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
    }

    /* God Mode specific styles */
    #godModeDisplay {
      position: fixed;
      top: 10px;
      right: 10px;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      font-size: 24px;
      font-weight: bold;
      color: #000;
      z-index: 1000;
      display: none; /* Hidden by default */
    }

    /* Style for the results header and button */
    #resultsHeaderContainer {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px; /* Space between heading and button */
      margin-top: 40px; /* Adjust as needed */
      margin-bottom: 20px; /* Space below the header container */
    }
    #resultsHeaderContainer h2 {
      margin: 0; /* Remove default margin from h2 */
    }

    /* New styles for the main layout table */
    .main-layout-table {
        width: 100%;
        border-collapse: collapse; /* Hides table borders */
    }
    .main-layout-table td {
        border: none; /* Explicitly remove cell borders */
        padding: 10px; /* Add some padding as needed */
        vertical-align: middle; /* Align content to the middle vertically */
        text-align: center; /* Center content horizontally within each cell */
    }
    .main-layout-table .left-column {
        width: 550px; /* Adjust width for the image and its padding */
    }
    .main-layout-table .right-column {
        /* No specific text-align needed here as it's set on .main-layout-table td */
    }
  </style>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
</head>
<body>

<table class="main-layout-table">
    <tr>
        <td class="left-column">
            <img src="https://iamsuperrich2025.github.io/foreducation/y-625.png" border="0" width="625" height="625">
        </td>
        <td class="right-column">
            <h1>üéØ Word Ascent</h1>
            <p class="intro-text"><font face="TH SarabunIT?">‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡πÅ‡∏ö‡∏ö Active Learning ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6 <br>
            ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡∏ö‡∏ô‡∏£‡∏∞‡∏ö‡∏ö OBEC Content Center ‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Word Ascent ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô PC</font></p>
            
            <div id="playerNameInput">
                <input type="text" id="playerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö" autocomplete="off" />
            </div>
            <button id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ </button> ** ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö **
            <button id="godModeBtn">God Mode</button>

            <div id="gameSection">
                <p class="game-instruction"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</strong></p>
                <div id="timerDisplay">‡πÄ‡∏ß‡∏•‡∏≤: 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
                <div id="scoreDisplay">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</div>
                <div id="progressBar" style="width: 80%; margin: 20px auto; height: 30px; background-color: #ddd; border-radius: 10px; overflow: hidden; position: relative;">
                    <div id="progress" style="height: 100%; width: 0%; background-color: #f44336;"></div>
                    <div id="progressLabel" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; line-height: 30px; text-align: center; font-weight: bold; color: black;">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                </div>
                <div id="wordInfo"></div>
                <button id="speakWordBtn">üîä ‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
                <br>
                <input type="text" id="gameInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå" autocomplete="off" />
                <br>
                <button id="submitBtn">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
                <div id="feedback"></div>
                <p><button id="restartBtn">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button></p>
            </div>

            <div id="resultsSection">
                <div id="resultsHeaderContainer">
                    <h2>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
                    <button id="exportExcelBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Excel</button>
                </div>
                <div id="resultsTableContainer">
                    <table id="resultsTable">
                        <thead>
                            <tr>
                                <th rowspan="2">‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th colspan="30" style="text-align: center;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö</th> <th rowspan="2">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                <th rowspan="2">‡∏£‡∏∞‡∏î‡∏±‡∏ö</th>
                            </tr>
                            <tr>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="godModeDisplay"></div>

            <p><font face="TH SarabunIT?">‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏ô‡∏¥‡∏£‡∏∏‡∏ï‡∏ï‡πå ‡∏û‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô</font></p>
            <p><img src="https://i.postimg.cc/bNtR4Fqm/gdkeepodld.jpg" border="0" width="58" height="58"><br>
            <font face="TH SarabunIT?">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå<br>
            ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£ ‡πÄ‡∏Ç‡∏ï 1</font></p>

            <audio id="backgroundMusic" loop>
                <source src="https://iamsuperrich2025.github.io/foreducation/bgquietsound.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
            <audio id="correctSound">
                <source src="https://iamsuperrich2025.github.io/foreducation/correct.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
            <audio id="incorrectSound">
                <source src="https://iamsuperrich2025.github.io/foreducation/wrong.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<script>
const words = [
  { "word": "achievement", "pronunciation": "‡∏≠‡∏∞-‡∏ä‡∏µ‡∏ü-‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏∫", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" },
  { "word": "bravery", "pronunciation": "‡πÄ‡∏ö‡∏£‡∏ü-‡πÄ‡∏ß‡∏≠-‡∏£‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç" },
  { "word": "culture", "pronunciation": "‡∏Ñ‡∏±‡∏•-‡πÄ‡∏ä‡∏≠‡∏£‡πå", "meaning": "‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°" },
  { "word": "democracy", "pronunciation": "‡∏î‡∏µ-‡∏°‡πá‡∏≠‡∏Ñ-‡∏Ñ‡∏£‡∏∞-‡∏ã‡∏µ‡πà", "meaning": "‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ò‡∏¥‡∏õ‡πÑ‡∏ï‡∏¢" },
  { "word": "education", "pronunciation": "‡πÄ‡∏≠‡∏î-‡∏î‡∏π-‡πÄ‡∏Ñ-‡∏ä‡∏±‡πà‡∏ô", "meaning": "‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤" },
  { "word": "freedom", "pronunciation": "‡∏ü‡∏£‡∏µ-‡∏î‡∏≠‡∏°", "meaning": "‡πÄ‡∏™‡∏£‡∏µ‡∏†‡∏≤‡∏û" },
  { "word": "goal", "pronunciation": "‡πÇ‡∏Å‡∏•", "meaning": "‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢" },
  { "word": "honest", "pronunciation": "‡∏≠‡∏≠‡∏ô-‡πÄ‡∏ô‡∏™‡∏ó‡∏∫", "meaning": "‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå" },
  { "word": "imagination", "pronunciation": "‡∏≠‡∏¥-‡πÅ‡∏°-‡∏à‡∏¥-‡πÄ‡∏ô-‡∏ä‡∏±‡πà‡∏ô", "meaning": "‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£" },
  { "word": "justice", "pronunciation": "‡∏à‡∏±‡∏™-‡∏ó‡∏¥‡∏™", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°" },
  { "word": "nation", "pronunciation": "‡πÄ‡∏ô-‡∏ä‡∏±‡πà‡∏ô", "meaning": "‡∏ä‡∏≤‡∏ï‡∏¥" },
  { "word": "responsibility", "pronunciation": "‡∏£‡∏µ-‡∏™‡∏õ‡∏≠‡∏ô-‡∏ã‡∏¥-‡∏ö‡∏¥-‡∏•‡∏¥-‡∏ó‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö" },
  { "word": "liberty", "pronunciation": "‡∏•‡∏¥-‡πÄ‡∏ö‡∏≠-‡∏ó‡∏µ‡πà", "meaning": "‡∏≠‡∏¥‡∏™‡∏£‡∏†‡∏≤‡∏û" },
  { "word": "honor", "pronunciation": "‡∏≠‡∏≠‡∏ô-‡πÄ‡∏ô‡∏≠‡∏£‡πå", "meaning": "‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏¢‡∏®" },
  { "word": "volunteer", "pronunciation": "‡∏ß‡∏≠‡∏•-‡∏•‡∏±‡∏ô-‡πÄ‡∏ó‡∏µ‡∏¢‡∏£‡πå", "meaning": "‡∏≠‡∏≤‡∏™‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£" },
  { "word": "peace", "pronunciation": "‡∏û‡∏µ‡∏ã", "meaning": "‡∏™‡∏±‡∏ô‡∏ï‡∏¥‡∏†‡∏≤‡∏û" },
  { "word": "truth", "pronunciation": "‡∏ó‡∏£‡∏π‡∏ò", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á" },
  { "word": "effort", "pronunciation": "‡πÄ‡∏≠‡∏ü-‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ó", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°" },
  { "word": "politeness", "pronunciation": "‡∏û‡∏≠-‡πÑ‡∏•‡∏ó‡∏∫-‡πÄ‡∏ô‡∏™", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏†‡∏≤‡∏û" },
  { "word": "unity", "pronunciation": "‡∏¢‡∏π-‡∏ô‡∏¥-‡∏ó‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ" },
  { "word": "equality", "pronunciation": "‡∏≠‡∏µ-‡∏Ñ‡∏ß‡∏≠‡∏•-‡∏•‡∏¥-‡∏ó‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°" },
  { "word": "integrity", "pronunciation": "‡∏≠‡∏¥‡∏ô-‡πÄ‡∏ó‡∏Å-‡∏£‡∏¥-‡∏ó‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏™‡∏∏‡∏à‡∏£‡∏¥‡∏ï" },
  { "word": "generosity", "pronunciation": "‡πÄ‡∏à‡∏ô-‡πÄ‡∏ô‡∏≠-‡∏£‡∏≠-‡∏ã‡∏¥-‡∏ó‡∏µ‡πà", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡πÄ‡∏ü‡∏∑‡πâ‡∏≠‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡πà" },
  { "word": "patience", "pronunciation": "‡πÄ‡∏û-‡πÄ‡∏ä‡∏¥‡∏ô‡∏ã‡∏∫", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏î‡∏ó‡∏ô" },
  { "word": "gratitude", "pronunciation": "‡πÅ‡∏Å‡∏£‡∏ó-‡∏ó‡∏¥-‡∏ó‡∏π‡∏î", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ï‡∏±‡∏ç‡∏ç‡∏π" },
  { "word": "respect", "pronunciation": "‡∏£‡∏µ-‡∏™‡πÄ‡∏õ‡∏Ñ‡∏ó‡∏∫", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û" },
  { "word": "cooperation", "pronunciation": "‡πÇ‡∏Ñ-‡∏≠‡∏≠-‡πÄ‡∏û‡∏≠‡∏∞-‡πÄ‡∏£-‡∏ä‡∏±‡πà‡∏ô", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠" },
  { "word": "discipline", "pronunciation": "‡∏î‡∏¥‡∏™-‡∏ã‡∏¥-‡∏û‡∏•‡∏¥‡∏ô", "meaning": "‡∏ß‡∏¥‡∏ô‡∏±‡∏¢" },
  { "word": "confidence", "pronunciation": "‡∏Ñ‡∏≠‡∏ô-‡∏ü‡∏¥-‡πÄ‡∏î‡∏¥‡∏ô‡∏ã‡∏∫", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à" },
  { "word": "leadership", "pronunciation": "‡∏•‡∏µ‡∏î-‡πÄ‡∏î‡∏≠‡∏£‡πå-‡∏ä‡∏¥‡∏û", "meaning": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥" }
];


let selectedVoice = null;
let isGameRunning = false;
let currentWord = "";
let currentPronunciation = "";
let currentMeaning = "";
let score = 0;
let timeLeft = 0;
let timer;
let wordsUsed = []; // Stores words shown in the current game
let currentAttemptResults = {}; // Stores correctness for each word in the current game
const allGameResults = []; // Stores results from all games played
let isGodModeActive = false; // New state variable for God Mode

// DOM Elements
const startBtn = document.getElementById("startBtn");
const restartBtn = document.getElementById("restartBtn");
const submitBtn = document.getElementById("submitBtn");
const gameInput = document.getElementById("gameInput");
const gameSection = document.getElementById("gameSection");
const feedback = document.getElementById("feedback");
const scoreDisplay = document.getElementById("scoreDisplay");
const timerDisplay = document.getElementById("timerDisplay");
const wordInfo = document.getElementById("wordInfo");
const speakWordBtn = document.getElementById("speakWordBtn");
const playerNameInputDiv = document.getElementById("playerNameInput");
const playerNameField = document.getElementById("playerName");
const resultsSection = document.getElementById("resultsSection");
const resultsTableBody = document.querySelector("#resultsTable tbody");
const resultsTableHeaderRow2 = document.querySelector("#resultsTable thead tr:nth-child(2)");
const resultsTableHeaderColspan = document.querySelector("#resultsTable thead th:nth-child(2)"); // The colspan cell

// Audio elements
const backgroundMusic = document.getElementById("backgroundMusic");
const correctSound = document.getElementById("correctSound");
const incorrectSound = document.getElementById("incorrectSound");

const godModeBtn = document.getElementById("godModeBtn"); // God Mode button
const godModeDisplay = document.getElementById("godModeDisplay"); // God Mode display element
const exportExcelBtn = document.getElementById("exportExcelBtn"); // Export Excel button

function loadVoices() {
  const voices = speechSynthesis.getVoices();
  if (!voices.length) {
    setTimeout(loadVoices, 100);
    return;
  }
  selectedVoice = voices.find(v => v.name.includes("Google US English")) || voices.find(v => v.lang.startsWith("en"));
}
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

// Pre-load a dummy utterance to activate speech synthesis on some mobile browsers
// This is critical for getting audio to play on first user interaction,
// especially on mobile browsers that block autoplay.
document.body.addEventListener('touchstart', () => {
  const dummy = new SpeechSynthesisUtterance("Hello");
  dummy.volume = 0;
  speechSynthesis.speak(dummy);
  // Also attempt to play a silent background music to prime for later
  backgroundMusic.volume = 0;
  backgroundMusic.play().catch(e => console.log("Silent autoplay prevented:", e));
  backgroundMusic.pause();
  backgroundMusic.volume = 1; // Reset volume
}, { once: true });


function speak(text) {
  speechSynthesis.cancel();  
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'en-US';  
  if (selectedVoice) utter.voice = selectedVoice;  
  utter.rate = 0.9;  
  utter.volume = 1; // Explicitly set volume to 1 (maximum)
  speechSynthesis.speak(utter);
}

function startGame() {
  const playerName = playerNameField.value.trim();
  if (playerName === "") {
    feedback.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö";
    feedback.className = "incorrect";  
    playerNameField.focus();
    return;
  }

  isGameRunning = true;
  playerNameInputDiv.style.display = "none";
  startBtn.style.display = "none";
  godModeBtn.style.display = "none"; // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° God Mode ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
  gameSection.style.display = "block";
  resultsSection.style.display = "none";

  feedback.textContent = "";
  score = 0;
  timeLeft = 0;
  wordsUsed = [];
  currentAttemptResults = {};

  scoreDisplay.textContent = "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0";
  timerDisplay.textContent = "‡πÄ‡∏ß‡∏•‡∏≤: 0 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ";
  gameInput.value = "";
  gameInput.focus();
  
  if (isGodModeActive) { // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏•‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ñ‡πâ‡∏≤ God Mode ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà
    godModeDisplay.style.display = "block";
  }

  nextWord(); // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏£‡∏Å

  // Play background music when the game starts
  backgroundMusic.play().catch(e => console.log("Background music autoplay prevented:", e));

  timer = setInterval(() => {
    timeLeft++;
    timerDisplay.textContent = "‡πÄ‡∏ß‡∏•‡∏≤: " + timeLeft + " ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ";
    if (wordsUsed.length >= words.length) {  
      clearInterval(timer);
      endGame();
    }
  }, 1000);
}

function nextWord() {
  const progressPercent = Math.min((wordsUsed.length / words.length) * 100, 100);  
  document.getElementById("progress").style.width = progressPercent + "%";
  const progressLabel = document.getElementById("progressLabel");
  const progressBar = document.getElementById("progress");
  
  if (progressPercent <= 20) {
    progressBar.style.backgroundColor = "#f44336";
    progressLabel.textContent = ""; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ProgressBar
  } else if (progressPercent <= 40) {
    progressBar.style.backgroundColor = "#ff9800";
    progressLabel.textContent = ""; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ProgressBar
  } else if (progressPercent <= 60) {
    progressBar.style.backgroundColor = "#ffeb3b";
    progressLabel.textContent = ""; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ProgressBar
  } else if (progressPercent <= 80) {
    progressBar.style.backgroundColor = "#4caf50";
    progressLabel.textContent = ""; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ProgressBar
  } else {
    progressBar.style.backgroundColor = "#2196f3";
    progressLabel.textContent = ""; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ProgressBar
  }

  if (wordsUsed.length >= words.length) {
    endGame();
    return;
  }

  const remaining = words.filter(w => !wordsUsed.includes(w.word));
  const entry = remaining[Math.floor(Math.random() * remaining.length)];
  currentWord = entry.word;
  currentPronunciation = entry.pronunciation;
  currentMeaning = entry.meaning;
  wordsUsed.push(currentWord);

  if (!(currentWord in currentAttemptResults)) {
      currentAttemptResults[currentWord] = false;  
  }

  const letterPronunciationMap = {
    a: "‡πÄ‡∏≠", b: "‡∏ö‡∏µ", c: "‡∏ã‡∏µ", d: "‡∏î‡∏µ", e: "‡∏≠‡∏µ",
    f: "‡πÄ‡∏≠‡∏ü", g: "‡∏à‡∏µ", h: "‡πÄ‡∏Æ‡∏ä", i: "‡πÑ‡∏≠", j: "‡πÄ‡∏à",
    k: "‡πÄ‡∏Ñ", l: "‡πÅ‡∏≠‡∏•", m: "‡πÄ‡∏≠‡πá‡∏°", n: "‡πÄ‡∏≠‡πá‡∏ô", o: "‡πÇ‡∏≠",
    p: "‡∏û‡∏µ", q: "‡∏Ñ‡∏¥‡∏ß", r: "‡∏≠‡∏≤‡∏£‡πå", s: "‡πÄ‡∏≠‡∏™", t: "‡∏ó‡∏µ",
    u: "‡∏¢‡∏π", v: "‡∏ß‡∏µ", w: "‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡∏•‡∏¢‡∏π", x: "‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå", y: "‡∏ß‡∏≤‡∏¢", z: "‡πÅ‡∏ã‡∏î"
  };
  const spelledThai = currentWord.toLowerCase().split('').map(ch => letterPronunciationMap[ch] || ch).join('-');
  wordInfo.innerHTML = `
    <p>‡∏™‡∏∞‡∏Å‡∏î‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß (‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ó‡∏¢): <strong>${spelledThai}</strong></p>
    <p>‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô: <strong>${currentPronunciation}</strong></p>
    <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: <strong>${currentMeaning}</strong></p>
  `;
  
  speak(currentWord);

  // Update God Mode display
  if (isGodModeActive) {
    godModeDisplay.textContent = currentWord;
    godModeDisplay.style.display = "block"; // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà
  } else {
    godModeDisplay.textContent = "";  
    godModeDisplay.style.display = "none"; // ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ God Mode ‡∏õ‡∏¥‡∏î
  }

  gameInput.value = "";
  gameInput.focus();
}

function submitAnswer() {
  if (!isGameRunning) return;
  const input = gameInput.value.trim().toLowerCase();
  
  if (input === currentWord.toLowerCase()) {
    score++;
    feedback.textContent = "‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!";
    feedback.className = "correct";
    currentAttemptResults[currentWord] = true;
    correctSound.play(); // Play correct sound
  } else {
    feedback.textContent = "‚ùå ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠: " + currentWord;
    feedback.className = "incorrect";
    currentAttemptResults[currentWord] = false;
    incorrectSound.play(); // Play incorrect sound
  }
  scoreDisplay.textContent = "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: " + score;
  nextWord();
}

function getLevelTextAndClass(finalScore) {
  let resultText = "";
  let resultClass = "";

  if (finalScore >= 27) {
    resultText = "‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°";
    resultClass = "excellent";
  } else if (finalScore >= 23) {
    resultText = "‡∏î‡∏µ";
    resultClass = "good";
  } else if (finalScore >= 19) {
    resultText = "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á";
    resultClass = "medium";
  } else if (finalScore >= 15) {
    resultText = "‡∏û‡∏≠‡πÉ‡∏ä‡πâ";
    resultClass = "fair";
  } else {
    resultText = "‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á";
    resultClass = "poor";
  }
  return { text: resultText, className: resultClass };
}

function endGame() {
  isGameRunning = false;
  clearInterval(timer);
  
  backgroundMusic.pause(); // Pause background music when the game ends
  backgroundMusic.currentTime = 0; // Reset music to the beginning for next play

  const { text: levelText, className: levelClass } = getLevelTextAndClass(score);

  feedback.innerHTML = `üèÅ ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö! ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô <strong>${score}</strong> ‡∏à‡∏≤‡∏Å ${words.length} ‡∏Ñ‡∏≥ ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ <strong>${timeLeft}</strong> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ<br><span class="${levelClass}">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${levelText}</span>`;
  feedback.className = "";  

  const playerResult = {
      name: playerNameField.value.trim() === "" ? "‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠" : playerNameField.value.trim(),
      score: score,
      level: levelText,
      wordResults: {}
  };

  words.forEach(wordObj => {
      playerResult.wordResults[wordObj.word] = currentAttemptResults[wordObj.word] !== undefined ? currentAttemptResults[wordObj.word] : false;
  });

  allGameResults.push(playerResult);

  gameSection.style.display = "none";
  resultsSection.style.display = "block";
  playerNameInputDiv.style.display = "block";
  startBtn.style.display = "block";
  godModeBtn.style.display = "block"; // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° God Mode ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
  godModeDisplay.style.display = "none"; // ‡∏ã‡πà‡∏≠‡∏ô God Mode display ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö‡πÄ‡∏Å‡∏°

  updateResultsTable();
}

function updateResultsTable() {
    resultsTableBody.innerHTML = '';
    
    if (resultsTableHeaderRow2.children.length === 0 || resultsTableHeaderColspan.getAttribute("colspan") !== words.length.toString()) {  
      resultsTableHeaderRow2.innerHTML = '';  

      words.forEach(wordObj => {
          const th = document.createElement("th");
          const div = document.createElement("div");
          div.className = "vertical-text";
          div.textContent = wordObj.word;
          th.appendChild(div);
          resultsTableHeaderRow2.appendChild(th);
      });
      resultsTableHeaderColspan.setAttribute("colspan", words.length);
    }

    allGameResults.forEach(result => {
        const row = resultsTableBody.insertRow();
        const nameCell = row.insertCell();
        nameCell.textContent = result.name;

        words.forEach(wordObj => {
            const cell = row.insertCell();
            const isCorrect = result.wordResults[wordObj.word];
            if (isCorrect) {
                cell.textContent = "‚úì";
                cell.className = "correct-mark";
            } else {
                cell.textContent = "‚úó";
                cell.className = "incorrect-mark";
            }
        });

        const scoreCell = row.insertCell();
        scoreCell.textContent = result.score;
        
        const levelCell = row.insertCell();
        levelCell.textContent = result.level;
        levelCell.className = getLevelTextAndClass(result.score).className;
    });
}

function toggleGodMode() {
  isGodModeActive = !isGodModeActive; // ‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ God Mode
  if (isGodModeActive) {
    godModeBtn.textContent = "God Mode: ‡πÄ‡∏õ‡∏¥‡∏î";
    if (isGameRunning) { // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      godModeDisplay.textContent = currentWord;
      godModeDisplay.style.display = "block";
    }
  } else {
    godModeBtn.textContent = "God Mode: ‡∏õ‡∏¥‡∏î";
    godModeDisplay.style.display = "none"; // ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ God Mode ‡∏õ‡∏¥‡∏î
    godModeDisplay.textContent = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î God Mode
  }
}

function exportToExcel() {
    let csvContent = "data:text/csv;charset=utf-8,\uFEFF"; // Add BOM for proper Thai character display in Excel

    // Create header row for CSV
    let header = ["‡∏ä‡∏∑‡πà‡∏≠"];
    words.forEach(wordObj => {
        header.push(wordObj.word); // Each word as a header
    });
    header.push("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô");
    header.push("‡∏£‡∏∞‡∏î‡∏±‡∏ö");
    csvContent += header.join(",") + "\r\n";

    // Add data rows
    allGameResults.forEach(result => {
        let row = [];
        row.push(`"${result.name}"`); // Enclose name in quotes to handle commas
        words.forEach(wordObj => {
            const isCorrect = result.wordResults[wordObj.word];
            row.push(isCorrect ? "‚úì" : "‚úó");
        });
        row.push(result.score);
        row.push(`"${result.level}"`); // Enclose level in quotes
        csvContent += row.join(",") + "\r\n";
    });

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "WordAscent_Results.csv");
    document.body.appendChild(link); // Required for Firefox
    link.click();
    document.body.removeChild(link); // Clean up
}


document.addEventListener("DOMContentLoaded", function() {
  gameSection.style.display = "none";
  resultsSection.style.display = "none";
  godModeDisplay.style.display = "none"; // ‡∏ã‡πà‡∏≠‡∏ô God Mode display ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

  startBtn.addEventListener("click", startGame);
  restartBtn.addEventListener("click", startGame);
  submitBtn.addEventListener("click", submitAnswer);
  godModeBtn.addEventListener("click", toggleGodMode);
  
  // Add Event Listener for the new export button
  const exportExcelBtn = document.getElementById("exportExcelBtn");
  if (exportExcelBtn) {
      exportExcelBtn.addEventListener("click", exportToExcel);
  }

  speakWordBtn.addEventListener("click", () => {
    if (isGameRunning && currentWord) {
      speak(currentWord);
    }
  });

  gameInput.addEventListener("keypress", function(e) {
    if (e.key === "Enter") submitAnswer();
  });

  playerNameField.focus();
});
</script>

</body>
</html>